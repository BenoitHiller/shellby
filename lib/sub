#!/bin/bash

declare -r user="$1"
declare -r logDir="$2"

declare -r expression="$3"

declare -a logFiles=($(find $logDir -type f | sort -r | head -n 2))

tac "${logFiles[@]}" | gawk '$2 == userString  {
  if($0 ~ /^\S+\s+\S+\s+: ([^:]|(:[^s]))/)
  {
    s=$0
    sub(/^\S+\s+\S+\s+: ?/,"",s)
    print s
    exit 0
  }
}
' userString="$user" | sed -E "$expression"
