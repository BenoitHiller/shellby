#!/usr/bin/awk -f

BEGIN {
  FS=":"
}
{
  print $0 > "/dev/stderr"
  print $0
}

/^handler start / {
  handlers[$2]=1
}

/^handler stop / {
  delete handlers[$2]
}

/^handler list / {
  outputString = ""
  for (handler in handlers) {
    outputString = outputString " " handler
  }
  printf("PRIVMSG %s :%s\n",$2,outputString)
}
